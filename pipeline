# Omni-Stream 


```text
+-----------------------------------------------------------------------+
|                        PHASE 1: 实时流处理 (Ingestion)                 |
|            (后台持续运行，仅消耗 Encoder 算力，LLM 处于休眠状态)           |
+-----------------------------------------------------------------------+
       
       [ 🎥 视频流 Input ]                  [ 🎤 音频流 Input ]
              |                                     |
              v                                     v
  +-----------------------+              +-----------------------+
  |  👁️  VISUAL ENCODER  |               |   👂  WHISPER MODEL   |
  | (Qwen3-VL Vision Tower)|             |      (ASR / VAD)      |
  +-----------------------+              +-----------------------+
              |                                     |
    +---------+---------+                           |
    | (Split Output)    |                           |
    |                   |                           |
    v                   v                           v
+--------+      +---------------+        +-----------------------+
| 原始   |      |   🔧 MLP      |        | 音频 feature & 时间戳    |
| Tokens |      | (Projector)   |        +-----------+-----------+
| (256+) |      +---------------+                    |
+--------+              |                            |
    |                   v                            |
    |           +----------------+                   |
    |           |  压缩向量 (1x)  | <-----------------+
    |           +----------------+
    |                   |
    |                   v
+=======================+        +=======================+
|  📦 RAM / VRAM CACHE  |        |    🔍 VECTOR DB       |
| (存储 Raw Visual Tokens)|       | (存储压缩向量索引)       |
|   [Frame_T1: Tokens]  |        | [Time: T1 | Vector_A] |
|   [Frame_T2: Tokens]  |        | [Time: T2 | Vector_B] |
+=======================+        +=======================+
           ^                                 ^
           |                                 |
           | (等待被提取)                      | (等待被搜索)
           |                                 |


+-----------------------------------------------------------------------+
|                        PHASE 2: 交互与生成 (Inference)                 |
|              (仅当用户触发时启动，LLM 介入，零视觉推理开销)                |
+-----------------------------------------------------------------------+

       [ 👤 用户指令 / 触发器 ]
              |
              v
      +----------------+
      | 🔍 语义检索系统 |  -------->  (1. 在 Vector DB 中搜索 Top-K)
      +----------------+                |
              |                         v
              | <----------------- (2. 返回关键时间戳: T1, T5, T9)
              |
              v
      +----------------+
      | ⚡ Token 提取器 |  -------->  (3. 拿着时间戳去 Cache 抓数据)
      +----------------+                |
              |                         v
              | <----------------- (4. 返回 Frame T1, T5, T9 的原始 Tokens)
              |
              v
  +=======================================================+
  |                  🧠  LLM (Qwen3-VL Base)              |
  | ----------------------------------------------------- |
  | Input Context:                                        |
  | [System Prompt]                                       |
  | [Frame_T1_Tokens] + [Frame_T5_Tokens] (直接注入显存)     |
  | [Audio_Text_Context]                                  |
  | [User Instruction]                                    |
  +=======================================================+
              |
              v
      [ 💬 最终流式回答 (Streaming Response) ]
